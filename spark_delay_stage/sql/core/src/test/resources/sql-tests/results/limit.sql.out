-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 15


-- !query 0
set spark.sql.limit.flatGlobalLimit=false
-- !query 0 schema
struct<key:string,value:string>
-- !query 0 output
spark.sql.limit.flatGlobalLimit	false


-- !query 1
SELECT * FROM testdata LIMIT 2
-- !query 1 schema
struct<key:int,value:string>
-- !query 1 output
1	1
2	2


-- !query 2
SELECT * FROM arraydata LIMIT 2
-- !query 2 schema
struct<arraycol:array<int>,nestedarraycol:array<array<int>>>
-- !query 2 output
[1,2,3]	[[1,2,3]]
[2,3,4]	[[2,3,4]]


-- !query 3
SELECT * FROM mapdata LIMIT 2
-- !query 3 schema
struct<mapcol:map<int,string>>
-- !query 3 output
{1:"a1",2:"b1",3:"c1",4:"d1",5:"e1"}
{1:"a2",2:"b2",3:"c2",4:"d2"}


-- !query 4
SELECT * FROM testdata LIMIT 2 + 1
-- !query 4 schema
struct<key:int,value:string>
-- !query 4 output
1	1
2	2
3	3


-- !query 5
SELECT * FROM testdata LIMIT CAST(1 AS int)
-- !query 5 schema
struct<key:int,value:string>
-- !query 5 output
1	1


-- !query 6
SELECT * FROM testdata LIMIT -1
-- !query 6 schema
struct<>
-- !query 6 output
org.apache.spark.sql.AnalysisException
The limit expression must be equal to or greater than 0, but got -1;


-- !query 7
SELECT * FROM testData TABLESAMPLE (-1 ROWS)
-- !query 7 schema
struct<>
-- !query 7 output
org.apache.spark.sql.AnalysisException
The limit expression must be equal to or greater than 0, but got -1;


-- !query 8
SELECT * FROM testdata LIMIT CAST(1 AS INT)
-- !query 8 schema
struct<key:int,value:string>
-- !query 8 output
1	1


-- !query 9
SELECT * FROM testdata LIMIT CAST(NULL AS INT)
-- !query 9 schema
struct<>
-- !query 9 output
org.apache.spark.sql.AnalysisException
The evaluated limit expression must not be null, but got CAST(NULL AS INT);


-- !query 10
SELECT * FROM testdata LIMIT key > 3
-- !query 10 schema
struct<>
-- !query 10 output
org.apache.spark.sql.AnalysisException
The limit expression must evaluate to a constant value, but got (testdata.`key` > 3);


-- !query 11
SELECT * FROM testdata LIMIT true
-- !query 11 schema
struct<>
-- !query 11 output
org.apache.spark.sql.AnalysisException
The limit expression must be integer type, but got boolean;


-- !query 12
SELECT * FROM testdata LIMIT 'a'
-- !query 12 schema
struct<>
-- !query 12 output
org.apache.spark.sql.AnalysisException
The limit expression must be integer type, but got string;


-- !query 13
SELECT * FROM (SELECT * FROM range(10) LIMIT 5) WHERE id > 3
-- !query 13 schema
struct<id:bigint>
-- !query 13 output
4


-- !query 14
SELECT * FROM testdata WHERE key < 3 LIMIT ALL
-- !query 14 schema
struct<key:int,value:string>
-- !query 14 output
1	1
2	2
